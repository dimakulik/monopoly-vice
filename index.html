<!doctype html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
<title>monopoly_tg</title>

<style>
*{box-sizing:border-box}
html,body{
  margin:0;padding:0;
  width:100%;height:100%;
  background:#2b353d;
  overflow:hidden;
  font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Arial;
}

/* ---------- LAYOUT ---------- */
:root{
  --vh:1vh;
  --board:300px;
  --price-gap:6px;
  --price-h:18px;
  --price-w:24px;
}

#app{
  width:100%;
  height:calc(var(--vh)*100);
  display:flex;
  align-items:center;
  justify-content:center;
}

.outer{
  position:relative;
  width:calc(var(--board) + (var(--price-w) + var(--price-gap))*2);
  height:calc(var(--board) + (var(--price-h) + var(--price-gap))*2);
}

.board{
  position:absolute;
  left:50%;top:50%;
  transform:translate(-50%,-50%);
  width:var(--board);
  height:var(--board);
  background:rgba(10,14,18,.28);
  box-shadow:0 14px 40px rgba(0,0,0,.35);
}

/* ---------- CELLS ---------- */
.cell{
  position:absolute;
  background:#fff;
  border:2px solid rgba(0,0,0,.15);
  display:flex;
  align-items:center;
  justify-content:center;
}
.cell img{
  width:100%;
  height:100%;
  object-fit:contain;
  padding:6px;
}

/* ---------- PRICES ---------- */
.price{
  position:absolute;
  display:flex;
  align-items:center;
  justify-content:center;
  color:#fff;
  font-weight:900;
  border-radius:10px;
  background:#000;
  pointer-events:none;
  overflow:hidden;
}
.price span{
  display:block;
  white-space:nowrap;
  font-size:11px;
  transform-origin:center;
}

/* top / bottom */
.price.tb{
  height:var(--price-h);
  padding:0 4px;
}

/* left / right */
.price.lr{
  width:var(--price-w);
  padding:0;
}
.price.left span{ transform:rotate(-90deg); }
.price.right span{ transform:rotate(90deg); }

/* ---------- CHAT ---------- */
.chat{
  position:absolute;
  left:50%;
  bottom:14%;
  transform:translateX(-50%);
  width:72%;
  background:rgba(35,43,50,.85);
  border-radius:14px;
  padding:8px;
  display:flex;
  gap:8px;
}
.chat input{
  flex:1;
  height:36px;
  border-radius:999px;
  border:none;
  padding:0 14px;
  background:rgba(255,255,255,.12);
  color:#fff;
}
.chat button{
  width:42px;
  border:none;
  border-radius:999px;
  background:rgba(255,255,255,.2);
  color:#fff;
}
</style>
</head>

<body>
<div id="app">
  <div class="outer" id="outer">
    <div class="board" id="board">
      <div class="chat">
        <input placeholder="Введите сообщение">
        <button>➤</button>
      </div>
    </div>
  </div>
</div>

<script>
/* ---------- TELEGRAM FIX ---------- */
const tg = window.Telegram?.WebApp;
if(tg) tg.expand();
function setVH(){
  const h = tg?.viewportStableHeight || window.innerHeight;
  document.documentElement.style.setProperty('--vh',(h*0.01)+'px');
}
setVH(); window.addEventListener('resize',setVH);

/* ---------- DATA ---------- */
const prices = [
  "200k","400k","600k","800k","1,000k","1,200k","1,500k",
  "2,000k","2,200k","2,400k","2,600k","3,000k"
];
const colors=["#f97316","#ec4899","#22c55e","#3b82f6","#a855f7","#ef4444"];
const CORNERS=new Set([0,10,20,30]);
const board=document.getElementById('board');
const outer=document.getElementById('outer');

let cells=[],tags=[];

/* ---------- BUILD ---------- */
for(let i=0;i<40;i++){
  const c=document.createElement('div');
  c.className='cell';
  c.innerHTML='<img src="data:image/svg+xml;utf8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22240%22 height=%22240%22><rect width=%22240%22 height=%22240%22 fill=%22%23fff%22/><text x=%2250%25%22 y=%2258%25%22 font-size=%2236%22 text-anchor=%22middle%22>GO</text></svg>">';
  board.appendChild(c); cells.push(c);

  const p=document.createElement('div');
  p.className='price';
  p.style.background=colors[i%colors.length];
  p.innerHTML='<span>'+prices[i%prices.length]+'</span>';
  if(CORNERS.has(i)) p.style.display='none';
  outer.appendChild(p); tags.push(p);
}

/* ---------- LAYOUT ---------- */
function layout(){
  const size=parseInt(getComputedStyle(document.documentElement).getPropertyValue('--board'));
  const corner=Math.floor(size*0.135);
  const step=Math.floor((size-corner*2)/9);
  const gap=6,ph=18,pw=24;

  const br=board.getBoundingClientRect();
  const or=outer.getBoundingClientRect();
  const ox=br.left-or.left, oy=br.top-or.top;

  const setCell=(i,x,y,w,h)=>{
    Object.assign(cells[i].style,{left:x+'px',top:y+'px',width:w+'px',height:h+'px'});
  }
  const setPrice=(i,x,y,w,h,cls)=>{
    const el=tags[i];
    Object.assign(el.style,{left:(ox+x)+'px',top:(oy+y)+'px',width:w+'px',height:h+'px'});
    el.className='price '+cls;
    fit(el);
  }

  setCell(0,0,0,corner,corner);
  for(let i=1;i<=9;i++){setCell(i,corner+(i-1)*step,0,step,corner);setPrice(i,corner+(i-1)*step,-ph-gap,step,ph,'tb')}
  setCell(10,size-corner,0,corner,corner);

  for(let i=11;i<=19;i++){setCell(i,size-corner,corner+(i-11)*step,corner,step);setPrice(i,size+gap,corner+(i-11)*step,pw,step,'lr right')}
  setCell(20,size-corner,size-corner,corner,corner);

  for(let i=21;i<=29;i++){setCell(i,size-corner-(i-20)*step,size-corner,step,corner);setPrice(i,size-corner-(i-20)*step,size+gap,step,ph,'tb')}
  setCell(30,0,size-corner,corner,corner);

  for(let i=31;i<=39;i++){setCell(i,0,size-corner-(i-30)*step,corner,step);setPrice(i,-pw-gap,size-corner-(i-30)*step,pw,step,'lr left')}
}

function fit(el){
  const s=el.querySelector('span');
  if(!s) return;
  s.style.transform=s.parentElement.classList.contains('left')?'rotate(-90deg)':'rotate(90deg)';
  const need=s.scrollWidth;
  const lim=el.classList.contains('tb')?el.clientWidth:el.clientHeight;
  const scale=Math.min(1,(lim-2)/need);
  s.style.transform+=` scale(${scale})`;
}

/* ---------- SIZE ---------- */
function resize(){
  const H=tg?.viewportStableHeight||innerHeight;
  const W=innerWidth;
  const size=Math.min(W-80,H-180);
  document.documentElement.style.setProperty('--board',Math.max(240,size)+'px');
  requestAnimationFrame(layout);
}
resize(); window.addEventListener('resize',resize);
</script>
</body>
</html>
